<div class="container mx-auto px-4 py-8">
  <div class="mb-8">
    <div class="flex items-center justify-between">
      <div>
        <h1 class="text-3xl font-bold text-gray-900">Edit Session</h1>
        <p class="mt-2 text-gray-600">Update session details and settings</p>
      </div>
      <%= link_to "Back to Workspace", workspace_session_path(@session),
            class: "bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded" %>
    </div>
  </div>

  <%= form_with model: @session, local: true, class: "max-w-2xl" do |form| %>
    <% if @session.errors.any? %>
      <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6">
        <h3 class="font-bold">Please fix the following errors:</h3>
        <ul class="mt-2 list-disc list-inside">
          <% @session.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <div class="bg-white shadow rounded-lg p-6 space-y-6">
      <!-- Session Name -->
      <div>
        <%= form.label :name, class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.text_field :name,
            class: "block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500",
            placeholder: "Enter session name" %>
      </div>

      <!-- Session Description -->
      <div>
        <%= form.label :description, class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.text_area :description,
            rows: 4,
            class: "block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500",
            placeholder: "Describe the purpose of this session" %>
      </div>

      <!-- Session Status -->
      <div>
        <%= form.label :status, class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.select :status,
            options_for_select([
              ['Active', 'active'],
              ['Completed', 'completed'],
              ['Archived', 'archived']
            ], @session.status),
            {},
            class: "block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500" %>
      </div>

      <!-- Current Stats -->
      <div class="border-t pt-6">
        <h3 class="text-lg font-medium text-gray-900 mb-4">Session Statistics</h3>
        <div class="grid grid-cols-3 gap-4 text-center">
          <div>
            <div class="text-2xl font-bold text-blue-600"><%= @session.jql_queries.count %></div>
            <div class="text-sm text-gray-500">JQL Queries</div>
          </div>
          <div>
            <div class="text-2xl font-bold text-green-600"><%= @session.tickets.count %></div>
            <div class="text-sm text-gray-500">Tickets</div>
          </div>
          <div>
            <div class="text-2xl font-bold text-purple-600"><%= @session.recommendations.count %></div>
            <div class="text-sm text-gray-500">Recommendations</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Form Actions -->
    <div class="flex justify-between items-center mt-8">
      <div>
        <%= link_to "Delete Session", session_path(@session),
            method: :delete,
            data: {
              confirm: "Are you sure? This will permanently delete this session and all associated data."
            },
            class: "bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded" %>
      </div>
      <div class="space-x-3">
        <%= link_to "Cancel", workspace_session_path(@session),
              class: "bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded" %>
        <%= form.submit "Update Session",
              class: "bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded" %>
      </div>
    </div>
  <% end %>
</div>